<html>
    <head>
        <script>
            function initialize() {
                const now = Date.now() / 1000;
                const lastLoad = document.getElementById("last_call");
                const t_i = parseFloat(lastLoad.innerText);
                const timeElapsed = (now - t_i) / 60;
                
                if (timeElapsed > 5) {
                    console.log("Past 5 minutes!");
                    call = window.location.href.split("#")[1];
                    let [url, mess] = call.split("7c");
                    url = decodeURIComponent(url.replace(/[0-9a-f]{2}/g, '%$&'));
                    mess = decodeURIComponent(mess.replace(/[0-9a-f]{2}/g, '%$&'));
                    
                    getAPI(url, mess)
                } 
                else {
                    lastLoad.innerText = now.toString())
                }
            }
            
            async function callAPI(url, message, body){    
                fetch(url, {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json'},
                    ...body, 
                    content: message});
            }
            
            function getAPI(u, m) {
                 const response = fetch(url);
                 response.then(f=> f.text()).then(i=> callAPI(u, m, JSON.parse(i)));
            }

        </script>
    </head>
    <body onload="initialize()">
        loaded
        <p id="last_call">1714803137.994</p>
    </body>
</html>
